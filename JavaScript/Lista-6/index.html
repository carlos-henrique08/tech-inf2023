<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Baralho Truco</title>
    <link rel="stylesheet" href="../Lista-6/estilo.css">
</head>
<body>
    <main>
        <div class="navbar">
            <div class="info">
                Cartas Restantes:
                <span id="remaining" class="info">0</span>     
            </div>

            <div class="info">
                Deck ID:
                <span id="deck_id" class="info">_</span>
            </div>
        </div>
        <div class="mesa">
          <div class="cartas" id="carta1"></div>
          <div class="cartas" id="carta2"></div>
          <div class="cartas" id="carta3"></div>
        </div>    
        <div class="painel">
           <button class="botoes">Novo Baralho</button>
           <button class="botoes" onclick="olharCartas()">Mostrar</button>
           <button class="botoes" onclick="Reembaralhar()">Reembaralhar</button>
        </div>
    </main>
    <script>

function getJsonData(respostaAPI){
                const json = respostaAPI.json();
                return json;    
     
          }

          function atualizainfo(jsonData){
            if(! jsonData.success)
            throw new Error("Erro ao acessar dados da api");
            const deck_id = jsonData.deck_id;
            const remaining = jsonData.remaining;
            const info1 = document.getElementById("deck_id");
            const info2 = document.getElementById("remaining");  
            info1.innerText = deck_id;
            info2.innerText = remaining;

            return jsonData;
           }

function Reembaralhar(){
            fetch("https://deckofcardsapi.com/api/deck/eeznafetexr3/shuffle/?remaining=false")
            .then(getJsonData)
            .then(function(jsonData){
                console.log = (jsonData);
                if(jsonData.success){
                    alert("Baralho Reembaralhado")
                }      
            
            })
        }         
                                
function olharCartas(){
            fetch("https://deckofcardsapi.com/api/deck/eeznafetexr3/draw/?count=3")
            .then(getJsonData)
           .then(atualizainfo)
                .then(function(jsonData){
                const cards = jsonData.cards;

                for(let i=0; i<3; i++){
                    const id = `carta${i+1}`;
                    
                    const card = document.getElementById(id);
                    let img = card.querySelector('img')
                    
                    if(img == null){
                        img = document.createElement('img');      
                }
                img.setAttribute('src', cards[i].image);
                card.append(img);
                
            }                
            
             return jsonData;
            })
        
        }
    </script>

</body>
</html>